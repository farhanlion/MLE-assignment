[2025-11-09T11:12:47.198+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-09T11:12:47.215+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: data_pipeline_dag.train_model manual__2025-11-09T10:52:52.991419+00:00 [queued]>
[2025-11-09T11:12:47.230+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: data_pipeline_dag.train_model manual__2025-11-09T10:52:52.991419+00:00 [queued]>
[2025-11-09T11:12:47.231+0000] {taskinstance.py:2865} INFO - Starting attempt 6 of 7
[2025-11-09T11:12:47.263+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): train_model> on 2025-11-09 10:52:52.991419+00:00
[2025-11-09T11:12:47.267+0000] {standard_task_runner.py:72} INFO - Started process 7394 to run task
[2025-11-09T11:12:47.270+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'data_pipeline_dag', 'train_model', 'manual__2025-11-09T10:52:52.991419+00:00', '--job-id', '19', '--raw', '--subdir', 'DAGS_FOLDER/data_pipeline_dag.py', '--cfg-path', '/tmp/tmpsowzl4ou']
[2025-11-09T11:12:47.272+0000] {standard_task_runner.py:105} INFO - Job 19: Subtask train_model
[2025-11-09T11:12:47.345+0000] {task_command.py:467} INFO - Running <TaskInstance: data_pipeline_dag.train_model manual__2025-11-09T10:52:52.991419+00:00 [running]> on host 7468da456d69
[2025-11-09T11:12:47.420+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='data_pipeline_dag' AIRFLOW_CTX_TASK_ID='train_model' AIRFLOW_CTX_EXECUTION_DATE='2025-11-09T10:52:52.991419+00:00' AIRFLOW_CTX_TRY_NUMBER='6' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-09T10:52:52.991419+00:00'
[2025-11-09T11:12:47.421+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-09T11:12:47.433+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-09T11:12:47.434+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /app/scripts/04_train_model.py']
[2025-11-09T11:12:47.441+0000] {subprocess.py:86} INFO - Output:
[2025-11-09T11:12:49.768+0000] {subprocess.py:93} INFO - Setting default log level to "WARN".
[2025-11-09T11:12:49.769+0000] {subprocess.py:93} INFO - To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[2025-11-09T11:12:49.920+0000] {subprocess.py:93} INFO - 25/11/09 11:12:49 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-11-09T11:12:58.336+0000] {subprocess.py:93} INFO - [Stage 2:==============>                                           (3 + 9) / 12]                                                                                {'model_train_date': datetime.datetime(2024, 9, 1, 0, 0),
[2025-11-09T11:12:58.338+0000] {subprocess.py:93} INFO -  'model_train_date_str': '2024-09-01',
[2025-11-09T11:12:58.339+0000] {subprocess.py:93} INFO -  'oot_end_date': datetime.datetime(2024, 8, 31, 0, 0),
[2025-11-09T11:12:58.339+0000] {subprocess.py:93} INFO -  'oot_period_months': 2,
[2025-11-09T11:12:58.340+0000] {subprocess.py:93} INFO -  'oot_start_date': datetime.datetime(2024, 7, 1, 0, 0),
[2025-11-09T11:12:58.340+0000] {subprocess.py:93} INFO -  'train_test_end_date': datetime.datetime(2024, 6, 30, 0, 0),
[2025-11-09T11:12:58.341+0000] {subprocess.py:93} INFO -  'train_test_period_months': 12,
[2025-11-09T11:12:58.342+0000] {subprocess.py:93} INFO -  'train_test_ratio': 0.8,
[2025-11-09T11:12:58.342+0000] {subprocess.py:93} INFO -  'train_test_start_date': datetime.datetime(2023, 7, 1, 0, 0)}
[2025-11-09T11:12:58.343+0000] {subprocess.py:93} INFO - extracted df_labels 6443 2023-07-01 00:00:00 2024-08-31 00:00:00
[2025-11-09T11:12:58.344+0000] {subprocess.py:93} INFO - +--------------------+-----------+-----+----------+-------------+
[2025-11-09T11:12:58.345+0000] {subprocess.py:93} INFO - |             loan_id|Customer_ID|label| label_def|snapshot_date|
[2025-11-09T11:12:58.345+0000] {subprocess.py:93} INFO - +--------------------+-----------+-----+----------+-------------+
[2025-11-09T11:12:58.346+0000] {subprocess.py:93} INFO - |CUS_0x1037_2023_0...| CUS_0x1037|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.347+0000] {subprocess.py:93} INFO - |CUS_0x1069_2023_0...| CUS_0x1069|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.348+0000] {subprocess.py:93} INFO - |CUS_0x114a_2023_0...| CUS_0x114a|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.348+0000] {subprocess.py:93} INFO - |CUS_0x1184_2023_0...| CUS_0x1184|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.349+0000] {subprocess.py:93} INFO - |CUS_0x1297_2023_0...| CUS_0x1297|    1|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.350+0000] {subprocess.py:93} INFO - |CUS_0x12fb_2023_0...| CUS_0x12fb|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.351+0000] {subprocess.py:93} INFO - |CUS_0x1325_2023_0...| CUS_0x1325|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.352+0000] {subprocess.py:93} INFO - |CUS_0x1341_2023_0...| CUS_0x1341|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.352+0000] {subprocess.py:93} INFO - |CUS_0x1375_2023_0...| CUS_0x1375|    1|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.353+0000] {subprocess.py:93} INFO - |CUS_0x13a8_2023_0...| CUS_0x13a8|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.353+0000] {subprocess.py:93} INFO - |CUS_0x13ef_2023_0...| CUS_0x13ef|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.354+0000] {subprocess.py:93} INFO - |CUS_0x1440_2023_0...| CUS_0x1440|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.355+0000] {subprocess.py:93} INFO - |CUS_0x1443_2023_0...| CUS_0x1443|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.356+0000] {subprocess.py:93} INFO - |CUS_0x145a_2023_0...| CUS_0x145a|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.356+0000] {subprocess.py:93} INFO - |CUS_0x1492_2023_0...| CUS_0x1492|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.357+0000] {subprocess.py:93} INFO - |CUS_0x153d_2023_0...| CUS_0x153d|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.358+0000] {subprocess.py:93} INFO - |CUS_0x1567_2023_0...| CUS_0x1567|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.359+0000] {subprocess.py:93} INFO - |CUS_0x15ad_2023_0...| CUS_0x15ad|    1|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.359+0000] {subprocess.py:93} INFO - |CUS_0x1630_2023_0...| CUS_0x1630|    1|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.360+0000] {subprocess.py:93} INFO - |CUS_0x169c_2023_0...| CUS_0x169c|    0|90dpd_7mob|   2023-08-01|
[2025-11-09T11:12:58.361+0000] {subprocess.py:93} INFO - +--------------------+-----------+-----+----------+-------------+
[2025-11-09T11:12:58.362+0000] {subprocess.py:93} INFO - only showing top 20 rows
[2025-11-09T11:12:58.363+0000] {subprocess.py:93} INFO - 
[2025-11-09T11:12:58.363+0000] {subprocess.py:93} INFO - extracted df_features 125636 2023-07-01 00:00:00 2024-08-31 00:00:00
[2025-11-09T11:12:58.364+0000] {subprocess.py:93} INFO - +-----------+-------------+---------------------+-----------------+---------------+-------------+-----------+-------------------+----------------------+--------------------+--------------------+----------+------------------------+--------------------+------------------+-------------+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-------------+
[2025-11-09T11:12:58.365+0000] {subprocess.py:93} INFO - |Customer_ID|Annual_Income|Monthly_Inhand_Salary|Num_Bank_Accounts|Num_Credit_Card|Interest_Rate|Num_of_Loan|Delay_from_due_date|Num_of_Delayed_Payment|Changed_Credit_Limit|Num_Credit_Inquiries|Credit_Mix|Credit_Utilization_Ratio|   Payment_Behaviour|Credit_History_Age|   Occupation|fe_1|fe_2|fe_3|fe_4|fe_5|fe_6|fe_7|fe_8|fe_9|fe_10|fe_11|fe_12|fe_13|fe_14|fe_15|fe_16|fe_17|fe_18|fe_19|fe_20|snapshot_date|
[2025-11-09T11:12:58.366+0000] {subprocess.py:93} INFO - +-----------+-------------+---------------------+-----------------+---------------+-------------+-----------+-------------------+----------------------+--------------------+--------------------+----------+------------------------+--------------------+------------------+-------------+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-------------+
[2025-11-09T11:12:58.367+0000] {subprocess.py:93} INFO - | CUS_0x6ba9|     20272.23|            1776.3525|              4.0|            3.0|         12.0|        1.0|               -1.0|                   5.0|                4.83|                 6.0|      Good|                  33.874|High_spent_Medium...|               332|       Lawyer| 102| 137| -26| 126| 131| -70| 105| -68| 145|   74|  200| -210|  145|  184|  248|   25|  -19|  164|   16|  184|   2024-03-01|
[2025-11-09T11:12:58.368+0000] {subprocess.py:93} INFO - | CUS_0x74c7|     87853.56|              7527.13|              4.0|            1.0|          4.0|        2.0|                2.0|                   2.0|                9.99|                 4.0|      Good|               27.837519|High_spent_Large_...|               208|   Unemployed|  74| 137|  26|  53| -13| 111| 239| 316| 162|  142|   83|   30|   -9|   18|  -50|  103|  -44|  111|  -55|   93|   2024-03-01|
[2025-11-09T11:12:58.369+0000] {subprocess.py:93} INFO - |  CUS_0xc65|         NULL|                 NULL|             NULL|           NULL|         NULL|       NULL|               NULL|                  NULL|                NULL|                NULL|      NULL|                    NULL|                NULL|              NULL|         NULL| 220|  73| 327| 110| 203| -95|  56| 180|  16|  156|   -7|   60|  230|  109|  147|   39|   10|  193|   72|   39|   2024-03-01|
[2025-11-09T11:12:58.369+0000] {subprocess.py:93} INFO - | CUS_0x5a8b|         NULL|                 NULL|             NULL|           NULL|         NULL|       NULL|               NULL|                  NULL|                NULL|                NULL|      NULL|                    NULL|                NULL|              NULL|         NULL| 232|  54| 192| 249| 309| 154| 207| 139| 133|  111|   80|  131|  -58|  -18|  169|  -27|  119|  106|  -18|  188|   2024-03-01|
[2025-11-09T11:12:58.370+0000] {subprocess.py:93} INFO - | CUS_0x78d3|    17773.775|             1388.148|              3.0|            1.0|          2.0|        2.0|                5.0|                   2.0|                4.57|                 4.0|      Good|               31.760332|Low_spent_Small_v...|               318|   Journalist| 114|  91|  97| 210| 158| -73|  20| -53| 119|  193|   73|  175|   25|  264|  272|  305|  133|  126|   81|   83|   2024-03-01|
[2025-11-09T11:12:58.371+0000] {subprocess.py:93} INFO - | CUS_0x7f5d|     20615.79|            1761.9825|              7.0|            7.0|         21.0|        7.0|               56.0|                  13.0|               10.01|                 8.0|  Standard|                37.84495|Low_spent_Small_v...|               148|      Teacher| 201| 147|   2| 162| 204|  55| 238|  11|  19|  164|   -2|   30|  153|   37|   68|  289|  228|  258|  200|  -96|   2024-03-01|
[2025-11-09T11:12:58.373+0000] {subprocess.py:93} INFO - | CUS_0x8eb2|         NULL|                 NULL|             NULL|           NULL|         NULL|       NULL|               NULL|                  NULL|                NULL|                NULL|      NULL|                    NULL|                NULL|              NULL|         NULL| 147|  92|  63| 165| 157| 211| 141| 115| 133|   51|   -6|   17|  111|   96|   14|  159|   14|   24|   44|  165|   2024-03-01|
[2025-11-09T11:12:58.373+0000] {subprocess.py:93} INFO - |  CUS_0xf6c|     76046.25|            6082.1875|              7.0|            3.0|         16.0|        3.0|               17.0|                  19.0|                3.29|                 9.0|  Standard|               22.548635|Low_spent_Small_v...|               368|       Writer|-151|  18|  41| 215| 291| -15|  19|  63| -32|  153|  225|  176|  199|    1|  116|  171|   15|  289|   65|  172|   2024-03-01|
[2025-11-09T11:12:58.374+0000] {subprocess.py:93} INFO - | CUS_0x7e24|     49854.92|            4216.5767|              8.0|            3.0|         17.0|        3.0|               17.0|                  18.0|                8.07|                 5.0|  Standard|               38.213825|             Unknown|               218|Media_Manager|  97| 147|  85| 159|  55| 159|  86|  45|  28|  210|   -7|  191|  200|  123|  171|   38|  144|  113|  -13|   42|   2024-03-01|
[2025-11-09T11:12:58.375+0000] {subprocess.py:93} INFO - | CUS_0xc65a|     33588.38|            2623.0317|              2.0|            1.0|         12.0|        2.0|                0.0|                  11.0|                8.24|                 4.0|      Good|               23.830828|High_spent_Large_...|               324|Media_Manager|  40| 104| 128| -23| 150| 163| 228| 176| 188|  159|  227|   90|   90|  151|  221|  179|  107| -104|  232|   13|   2024-03-01|
[2025-11-09T11:12:58.376+0000] {subprocess.py:93} INFO - |  CUS_0xebe|     28286.24|            2273.1868|              4.0|            7.0|          7.0|        1.0|               21.0|                  13.0|               11.99|                 4.0|  Standard|               28.700365|High_spent_Medium...|               356|   Journalist| 101| -24| 167|  31| 139| 198| -36|  96| 219|  108|  232|   83|  146|  138|  168|   24|  118|  -46|  148|  259|   2024-03-01|
[2025-11-09T11:12:58.376+0000] {subprocess.py:93} INFO - | CUS_0x1ed5|     18965.35|            1317.4458|             10.0|            7.0|         20.0|        3.0|               21.0|                  18.0|                7.33|                 6.0|       Bad|               27.237741|Low_spent_Small_v...|                96|      Teacher| 135| 200| 274|   6| 178|  18| 101|  63| 199|  209|  112|  -56|  -21|   57|  150|  -87|  -49|  -54|   71|  251|   2024-03-01|
[2025-11-09T11:12:58.377+0000] {subprocess.py:93} INFO - | CUS_0x5479|     29365.12|            2524.0933|              5.0|            5.0|         12.0|        1.0|               11.0|                  11.0|                7.04|                 5.0|         _|               25.221605|Low_spent_Large_v...|               316|     Musician|  75| 205|  67|  82|  83| 243| 252| -48|  81|    6|    8|  204|  221|   25|  218|   72|   81|   22|   95|   51|   2024-03-01|
[2025-11-09T11:12:58.379+0000] {subprocess.py:93} INFO - | CUS_0x7e8d|         NULL|                 NULL|             NULL|           NULL|         NULL|       NULL|               NULL|                  NULL|                NULL|                NULL|      NULL|                    NULL|                NULL|              NULL|         NULL| -34|  55| -53| 100| 243| 135|  29|  74| 285|    8|  202|   95|   32|   74|  136|   66|  124|   12|   47|   70|   2024-03-01|
[2025-11-09T11:12:58.379+0000] {subprocess.py:93} INFO - | CUS_0xb38d|     18409.79|            1594.1492|              7.0|           10.0|         16.0|        5.0|               33.0|                  25.0|                5.16|                11.0|       Bad|                33.87914|Low_spent_Small_v...|               111|      Teacher| -69| 140| 137| 205|  37| 207| 192| 123|  31|  122|  144|  161|  197|   21|   -1|   77|  148|   65|   45|  -41|   2024-03-01|
[2025-11-09T11:12:58.380+0000] {subprocess.py:93} INFO - | CUS_0xafeb|     15910.33|            1111.8608|              8.0|            8.0|         21.0|        9.0|               16.0|                  16.0|               15.26|                 8.0|         _|               30.943031|High_spent_Medium...|               170|      Manager| 117|  84|   0| 130| 112| 124| 112| 136|  61|  195|  264|  192|  241|   84|   89|  127|  242|   34|  189|  195|   2024-03-01|
[2025-11-09T11:12:58.382+0000] {subprocess.py:93} INFO - | CUS_0x1b0f|         NULL|                 NULL|             NULL|           NULL|         NULL|       NULL|               NULL|                  NULL|                NULL|                NULL|      NULL|                    NULL|                NULL|              NULL|         NULL| 159| 233|-181| 220|  18| 265|  39|  47|  44|  -29|  -17|  224|   73|  133|   96|   83|   62|  140|  169|  116|   2024-03-01|
[2025-11-09T11:12:58.383+0000] {subprocess.py:93} INFO - | CUS_0x834f|         NULL|                 NULL|             NULL|           NULL|         NULL|       NULL|               NULL|                  NULL|                NULL|                NULL|      NULL|                    NULL|                NULL|              NULL|         NULL| 143| 253| 367| 210|  23| 141| 145| 209|  17|  204|   17|    1|   63|  -52|  258|   28|  224|  141|  -18|   32|   2024-03-01|
[2025-11-09T11:12:58.383+0000] {subprocess.py:93} INFO - | CUS_0x856b|         NULL|                 NULL|             NULL|           NULL|         NULL|       NULL|               NULL|                  NULL|                NULL|                NULL|      NULL|                    NULL|                NULL|              NULL|         NULL| 107|  12|-167| -47| 256| 102| 148|  30| 130|  228|  271|   70|  246|  219|  151|  108|  239|   40|  143|  343|   2024-03-01|
[2025-11-09T11:12:58.384+0000] {subprocess.py:93} INFO - | CUS_0x8d3d|     16750.04|            1435.8367|              9.0|           10.0|         27.0|        6.0|               41.0|                  19.0|                29.4|                15.0|       Bad|               23.590292|Low_spent_Small_v...|               144|      Manager| 142| 129|   5| 306|  46| 209| 165|  63| 207|  200|  298|  119|  102|  -25|   49|  246|  -55|  301|  201|  120|   2024-03-01|
[2025-11-09T11:12:58.385+0000] {subprocess.py:93} INFO - +-----------+-------------+---------------------+-----------------+---------------+-------------+-----------+-------------------+----------------------+--------------------+--------------------+----------+------------------------+--------------------+------------------+-------------+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-------------+
[2025-11-09T11:12:58.386+0000] {subprocess.py:93} INFO - only showing top 20 rows
[2025-11-09T11:13:01.748+0000] {subprocess.py:93} INFO - [Stage 20:=>              (1 + 11) / 12][Stage 21:>                (0 + 1) / 12][Stage 20:=============>  (10 + 2) / 12][Stage 21:>               (0 + 10) / 12][Stage 21:>                                                       (0 + 12) / 12][Stage 21:===================>                                     (4 + 8) / 12][Stage 21:==============================================>         (10 + 2) / 12]                                                                                /app/utils/data_processing_before_fit.py:10: SettingWithCopyWarning:
[2025-11-09T11:13:01.749+0000] {subprocess.py:93} INFO - A value is trying to be set on a copy of a slice from a DataFrame.
[2025-11-09T11:13:01.749+0000] {subprocess.py:93} INFO - Try using .loc[row_indexer,col_indexer] = value instead
[2025-11-09T11:13:01.751+0000] {subprocess.py:93} INFO - 
[2025-11-09T11:13:01.751+0000] {subprocess.py:93} INFO - See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
[2025-11-09T11:13:01.752+0000] {subprocess.py:93} INFO -   input_df[c] = input_df[c].replace("_", np.nan)
[2025-11-09T11:13:01.771+0000] {subprocess.py:93} INFO - 
[2025-11-09T11:13:01.772+0000] {subprocess.py:93} INFO - Customer_ID nulls: 0 / 125636
[2025-11-09T11:13:01.774+0000] {subprocess.py:93} INFO - Row count: Customer_ID                 4987
[2025-11-09T11:13:01.776+0000] {subprocess.py:93} INFO - snapshot_date               4987
[2025-11-09T11:13:01.779+0000] {subprocess.py:93} INFO - loan_id                     4987
[2025-11-09T11:13:01.782+0000] {subprocess.py:93} INFO - label                       4987
[2025-11-09T11:13:01.793+0000] {subprocess.py:93} INFO - label_def                   4987
[2025-11-09T11:13:01.794+0000] {subprocess.py:93} INFO - Annual_Income               4987
[2025-11-09T11:13:01.795+0000] {subprocess.py:93} INFO - Monthly_Inhand_Salary       4987
[2025-11-09T11:13:01.796+0000] {subprocess.py:93} INFO - Num_Bank_Accounts           4987
[2025-11-09T11:13:01.806+0000] {subprocess.py:93} INFO - Num_Credit_Card             4987
[2025-11-09T11:13:01.811+0000] {subprocess.py:93} INFO - Interest_Rate               4987
[2025-11-09T11:13:01.816+0000] {subprocess.py:93} INFO - Num_of_Loan                 4987
[2025-11-09T11:13:01.827+0000] {subprocess.py:93} INFO - Delay_from_due_date         4987
[2025-11-09T11:13:01.828+0000] {subprocess.py:93} INFO - Num_of_Delayed_Payment      4987
[2025-11-09T11:13:01.829+0000] {subprocess.py:93} INFO - Changed_Credit_Limit        4987
[2025-11-09T11:13:01.830+0000] {subprocess.py:93} INFO - Num_Credit_Inquiries        4987
[2025-11-09T11:13:01.831+0000] {subprocess.py:93} INFO - Credit_Mix                  4987
[2025-11-09T11:13:01.832+0000] {subprocess.py:93} INFO - Credit_Utilization_Ratio    4987
[2025-11-09T11:13:01.838+0000] {subprocess.py:93} INFO - Payment_Behaviour           4987
[2025-11-09T11:13:01.843+0000] {subprocess.py:93} INFO - Credit_History_Age          4987
[2025-11-09T11:13:01.844+0000] {subprocess.py:93} INFO - Occupation                  4987
[2025-11-09T11:13:01.846+0000] {subprocess.py:93} INFO - fe_1                        4987
[2025-11-09T11:13:01.847+0000] {subprocess.py:93} INFO - fe_2                        4987
[2025-11-09T11:13:01.848+0000] {subprocess.py:93} INFO - fe_3                        4987
[2025-11-09T11:13:01.865+0000] {subprocess.py:93} INFO - fe_4                        4987
[2025-11-09T11:13:01.866+0000] {subprocess.py:93} INFO - fe_5                        4987
[2025-11-09T11:13:01.867+0000] {subprocess.py:93} INFO - fe_6                        4987
[2025-11-09T11:13:01.868+0000] {subprocess.py:93} INFO - fe_7                        4987
[2025-11-09T11:13:01.870+0000] {subprocess.py:93} INFO - fe_8                        4987
[2025-11-09T11:13:01.871+0000] {subprocess.py:93} INFO - fe_9                        4987
[2025-11-09T11:13:01.872+0000] {subprocess.py:93} INFO - fe_10                       4987
[2025-11-09T11:13:01.873+0000] {subprocess.py:93} INFO - fe_11                       4987
[2025-11-09T11:13:01.875+0000] {subprocess.py:93} INFO - fe_12                       4987
[2025-11-09T11:13:01.876+0000] {subprocess.py:93} INFO - fe_13                       4987
[2025-11-09T11:13:01.881+0000] {subprocess.py:93} INFO - fe_14                       4987
[2025-11-09T11:13:01.882+0000] {subprocess.py:93} INFO - fe_15                       4987
[2025-11-09T11:13:01.883+0000] {subprocess.py:93} INFO - fe_16                       4987
[2025-11-09T11:13:01.884+0000] {subprocess.py:93} INFO - fe_17                       4987
[2025-11-09T11:13:01.884+0000] {subprocess.py:93} INFO - fe_18                       4987
[2025-11-09T11:13:01.885+0000] {subprocess.py:93} INFO - fe_19                       4987
[2025-11-09T11:13:01.886+0000] {subprocess.py:93} INFO - fe_20                       4987
[2025-11-09T11:13:01.886+0000] {subprocess.py:93} INFO - dtype: int64
[2025-11-09T11:13:01.887+0000] {subprocess.py:93} INFO - X_train 3396
[2025-11-09T11:13:01.888+0000] {subprocess.py:93} INFO - X_test 850
[2025-11-09T11:13:01.889+0000] {subprocess.py:93} INFO - X_oot 741
[2025-11-09T11:13:01.892+0000] {subprocess.py:93} INFO - y_train 3396 0.27
[2025-11-09T11:13:01.893+0000] {subprocess.py:93} INFO - y_test 850 0.27
[2025-11-09T11:13:01.898+0000] {subprocess.py:93} INFO - y_oot 741 0.28
[2025-11-09T11:13:01.900+0000] {subprocess.py:93} INFO - X_train_processed 3396
[2025-11-09T11:13:01.901+0000] {subprocess.py:93} INFO - X_test_processed 850
[2025-11-09T11:13:01.905+0000] {subprocess.py:93} INFO - X_oot_processed 741
[2025-11-09T11:13:01.906+0000] {subprocess.py:93} INFO - Fitting 3 folds for each of 100 candidates, totalling 300 fits
[2025-11-09T11:13:06.709+0000] {subprocess.py:93} INFO - Best parameters found:  {'subsample': 0.8, 'reg_lambda': 1, 'reg_alpha': 1, 'n_estimators': 50, 'min_child_weight': 3, 'max_depth': 3, 'learning_rate': 0.1, 'gamma': 0, 'colsample_bytree': 0.8}
[2025-11-09T11:13:06.710+0000] {subprocess.py:93} INFO - Best AUC score:  0.685450912651809
[2025-11-09T11:13:06.711+0000] {subprocess.py:93} INFO - Train AUC score:  0.8745471396073806
[2025-11-09T11:13:06.711+0000] {subprocess.py:93} INFO - Test AUC score:  0.799541519875676
[2025-11-09T11:13:06.712+0000] {subprocess.py:93} INFO - OOT AUC score:  0.804681194511703
[2025-11-09T11:13:06.712+0000] {subprocess.py:93} INFO - TRAIN GINI score:  0.749
[2025-11-09T11:13:06.712+0000] {subprocess.py:93} INFO - Test GINI score:  0.599
[2025-11-09T11:13:06.716+0000] {subprocess.py:93} INFO - OOT GINI score:  0.609
[2025-11-09T11:13:06.717+0000] {subprocess.py:93} INFO - {'data_dates': {'model_train_date': datetime.datetime(2024, 9, 1, 0, 0),
[2025-11-09T11:13:06.718+0000] {subprocess.py:93} INFO -                 'model_train_date_str': '2024-09-01',
[2025-11-09T11:13:06.719+0000] {subprocess.py:93} INFO -                 'oot_end_date': datetime.datetime(2024, 8, 31, 0, 0),
[2025-11-09T11:13:06.719+0000] {subprocess.py:93} INFO -                 'oot_period_months': 2,
[2025-11-09T11:13:06.720+0000] {subprocess.py:93} INFO -                 'oot_start_date': datetime.datetime(2024, 7, 1, 0, 0),
[2025-11-09T11:13:06.721+0000] {subprocess.py:93} INFO -                 'train_test_end_date': datetime.datetime(2024, 6, 30, 0, 0),
[2025-11-09T11:13:06.721+0000] {subprocess.py:93} INFO -                 'train_test_period_months': 12,
[2025-11-09T11:13:06.722+0000] {subprocess.py:93} INFO -                 'train_test_ratio': 0.8,
[2025-11-09T11:13:06.723+0000] {subprocess.py:93} INFO -                 'train_test_start_date': datetime.datetime(2023, 7, 1, 0, 0)},
[2025-11-09T11:13:06.723+0000] {subprocess.py:93} INFO -  'data_stats': {'X_oot': 741,
[2025-11-09T11:13:06.724+0000] {subprocess.py:93} INFO -                 'X_test': 850,
[2025-11-09T11:13:06.728+0000] {subprocess.py:93} INFO -                 'X_train': 3396,
[2025-11-09T11:13:06.736+0000] {subprocess.py:93} INFO -                 'y_oot': np.float64(0.28),
[2025-11-09T11:13:06.737+0000] {subprocess.py:93} INFO -                 'y_test': np.float64(0.27),
[2025-11-09T11:13:06.738+0000] {subprocess.py:93} INFO -                 'y_train': np.float64(0.27)},
[2025-11-09T11:13:06.739+0000] {subprocess.py:93} INFO -  'hp_params': {'colsample_bytree': 0.8,
[2025-11-09T11:13:06.740+0000] {subprocess.py:93} INFO -                'gamma': 0,
[2025-11-09T11:13:06.745+0000] {subprocess.py:93} INFO -                'learning_rate': 0.1,
[2025-11-09T11:13:06.748+0000] {subprocess.py:93} INFO -                'max_depth': 3,
[2025-11-09T11:13:06.750+0000] {subprocess.py:93} INFO -                'min_child_weight': 3,
[2025-11-09T11:13:06.751+0000] {subprocess.py:93} INFO -                'n_estimators': 50,
[2025-11-09T11:13:06.752+0000] {subprocess.py:93} INFO -                'reg_alpha': 1,
[2025-11-09T11:13:06.753+0000] {subprocess.py:93} INFO -                'reg_lambda': 1,
[2025-11-09T11:13:06.757+0000] {subprocess.py:93} INFO -                'subsample': 0.8},
[2025-11-09T11:13:06.758+0000] {subprocess.py:93} INFO -  'model': XGBClassifier(base_score=None, booster=None, callbacks=None,
[2025-11-09T11:13:06.759+0000] {subprocess.py:93} INFO -               colsample_bylevel=None, colsample_bynode=None,
[2025-11-09T11:13:06.760+0000] {subprocess.py:93} INFO -               colsample_bytree=0.8, device=None, early_stopping_rounds=None,
[2025-11-09T11:13:06.761+0000] {subprocess.py:93} INFO -               enable_categorical=False, eval_metric='logloss',
[2025-11-09T11:13:06.761+0000] {subprocess.py:93} INFO -               feature_types=None, feature_weights=None, gamma=0,
[2025-11-09T11:13:06.769+0000] {subprocess.py:93} INFO -               grow_policy=None, importance_type=None,
[2025-11-09T11:13:06.776+0000] {subprocess.py:93} INFO -               interaction_constraints=None, learning_rate=0.1, max_bin=None,
[2025-11-09T11:13:06.778+0000] {subprocess.py:93} INFO -               max_cat_threshold=None, max_cat_to_onehot=None,
[2025-11-09T11:13:06.779+0000] {subprocess.py:93} INFO -               max_delta_step=None, max_depth=3, max_leaves=None,
[2025-11-09T11:13:06.780+0000] {subprocess.py:93} INFO -               min_child_weight=3, missing=nan, monotone_constraints=None,
[2025-11-09T11:13:06.781+0000] {subprocess.py:93} INFO -               multi_strategy=None, n_estimators=50, n_jobs=None,
[2025-11-09T11:13:06.781+0000] {subprocess.py:93} INFO -               num_parallel_tree=None, ...),
[2025-11-09T11:13:06.782+0000] {subprocess.py:93} INFO -  'model_name': 'xgb',
[2025-11-09T11:13:06.783+0000] {subprocess.py:93} INFO -  'model_version': 'credit_model_2024_09_01',
[2025-11-09T11:13:06.783+0000] {subprocess.py:93} INFO -  'preprocessing_transformers': {'stdscaler': StandardScaler()},
[2025-11-09T11:13:06.784+0000] {subprocess.py:93} INFO -  'results': {'auc_oot': np.float64(0.804681194511703),
[2025-11-09T11:13:06.785+0000] {subprocess.py:93} INFO -              'auc_test': np.float64(0.799541519875676),
[2025-11-09T11:13:06.785+0000] {subprocess.py:93} INFO -              'auc_train': np.float64(0.8745471396073806),
[2025-11-09T11:13:06.789+0000] {subprocess.py:93} INFO -              'gini_oot': np.float64(0.609),
[2025-11-09T11:13:06.792+0000] {subprocess.py:93} INFO -              'gini_test': np.float64(0.599),
[2025-11-09T11:13:06.793+0000] {subprocess.py:93} INFO -              'gini_train': np.float64(0.749)}}
[2025-11-09T11:13:06.794+0000] {subprocess.py:93} INFO - Model saved to model_bank/xgb_credit_model_2024_09_01.pkl
[2025-11-09T11:13:07.849+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-09T11:13:07.887+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-09T11:13:07.888+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=data_pipeline_dag, task_id=train_model, run_id=manual__2025-11-09T10:52:52.991419+00:00, execution_date=20251109T105252, start_date=20251109T111247, end_date=20251109T111307
[2025-11-09T11:13:07.928+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-09T11:13:07.941+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-11-09T11:13:07.943+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
