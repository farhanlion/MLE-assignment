[2025-11-09T11:23:28.326+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-11-09T11:23:28.341+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: scheduled_training_dag.inference scheduled__2025-01-01T00:00:00+00:00 [queued]>
[2025-11-09T11:23:28.351+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: scheduled_training_dag.inference scheduled__2025-01-01T00:00:00+00:00 [queued]>
[2025-11-09T11:23:28.352+0000] {taskinstance.py:2865} INFO - Starting attempt 2 of 2
[2025-11-09T11:23:28.384+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): inference> on 2025-01-01 00:00:00+00:00
[2025-11-09T11:23:28.390+0000] {standard_task_runner.py:72} INFO - Started process 17061 to run task
[2025-11-09T11:23:28.393+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'scheduled_training_dag', 'inference', 'scheduled__2025-01-01T00:00:00+00:00', '--job-id', '30', '--raw', '--subdir', 'DAGS_FOLDER/inference_monitoring_dag.py', '--cfg-path', '/tmp/tmpsg4kxi5u']
[2025-11-09T11:23:28.395+0000] {standard_task_runner.py:105} INFO - Job 30: Subtask inference
[2025-11-09T11:23:28.474+0000] {task_command.py:467} INFO - Running <TaskInstance: scheduled_training_dag.inference scheduled__2025-01-01T00:00:00+00:00 [running]> on host 7468da456d69
[2025-11-09T11:23:28.564+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='scheduled_training_dag' AIRFLOW_CTX_TASK_ID='inference' AIRFLOW_CTX_EXECUTION_DATE='2025-01-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-01-01T00:00:00+00:00'
[2025-11-09T11:23:28.565+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-11-09T11:23:28.578+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-09T11:23:28.580+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /app/scripts/05_run_inference.py']
[2025-11-09T11:23:28.587+0000] {subprocess.py:86} INFO - Output:
[2025-11-09T11:23:30.892+0000] {subprocess.py:93} INFO - Setting default log level to "WARN".
[2025-11-09T11:23:30.895+0000] {subprocess.py:93} INFO - To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
[2025-11-09T11:23:31.091+0000] {subprocess.py:93} INFO - 25/11/09 11:23:31 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[2025-11-09T11:23:32.085+0000] {subprocess.py:93} INFO - /app/scripts/05_run_inference.py:46: UserWarning: [11:23:32] WARNING: /workspace/src/collective/../data/../common/error_msg.h:82: If you are loading a serialized model (like pickle in Python, RDS in R) or
[2025-11-09T11:23:32.096+0000] {subprocess.py:93} INFO - configuration generated by an older version of XGBoost, please export the model by calling
[2025-11-09T11:23:32.097+0000] {subprocess.py:93} INFO - `Booster.save_model` from that version first, then load it back in current version. See:
[2025-11-09T11:23:32.098+0000] {subprocess.py:93} INFO - 
[2025-11-09T11:23:32.098+0000] {subprocess.py:93} INFO -     https://xgboost.readthedocs.io/en/stable/tutorials/saving_model.html
[2025-11-09T11:23:32.101+0000] {subprocess.py:93} INFO - 
[2025-11-09T11:23:32.102+0000] {subprocess.py:93} INFO - for more details about differences between saving model and serializing.
[2025-11-09T11:23:32.103+0000] {subprocess.py:93} INFO - 
[2025-11-09T11:23:32.103+0000] {subprocess.py:93} INFO -   model_artefact = pickle.load(file)
[2025-11-09T11:23:38.795+0000] {subprocess.py:93} INFO - [Stage 1:>                                                        (0 + 12) / 12]                                                                                {'model_artefact_filepath': '/app/model_bank/xgb_credit_model_2024_09_01.pkl',
[2025-11-09T11:23:38.796+0000] {subprocess.py:93} INFO -  'model_bank_directory': '/app/model_bank/',
[2025-11-09T11:23:38.796+0000] {subprocess.py:93} INFO -  'model_name': 'xgb_credit_model_2024_09_01.pkl',
[2025-11-09T11:23:38.797+0000] {subprocess.py:93} INFO -  'snapshot_date': datetime.datetime(2024, 12, 1, 0, 0),
[2025-11-09T11:23:38.798+0000] {subprocess.py:93} INFO -  'snapshot_date_str': '2024-12-01'}
[2025-11-09T11:23:38.798+0000] {subprocess.py:93} INFO - Model loaded successfully! /app/model_bank/xgb_credit_model_2024_09_01.pkl
[2025-11-09T11:23:38.800+0000] {subprocess.py:93} INFO - extracted features_sdf 8974 2024-12-01 00:00:00
[2025-11-09T11:23:38.801+0000] {subprocess.py:93} INFO - +-----------+-------------+---------------------+-----------------+---------------+-------------+-----------+-------------------+----------------------+--------------------+--------------------+----------+------------------------+--------------------+------------------+-------------+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-------------+
[2025-11-09T11:23:38.802+0000] {subprocess.py:93} INFO - |Customer_ID|Annual_Income|Monthly_Inhand_Salary|Num_Bank_Accounts|Num_Credit_Card|Interest_Rate|Num_of_Loan|Delay_from_due_date|Num_of_Delayed_Payment|Changed_Credit_Limit|Num_Credit_Inquiries|Credit_Mix|Credit_Utilization_Ratio|   Payment_Behaviour|Credit_History_Age|   Occupation|fe_1|fe_2|fe_3|fe_4|fe_5|fe_6|fe_7|fe_8|fe_9|fe_10|fe_11|fe_12|fe_13|fe_14|fe_15|fe_16|fe_17|fe_18|fe_19|fe_20|snapshot_date|
[2025-11-09T11:23:38.802+0000] {subprocess.py:93} INFO - +-----------+-------------+---------------------+-----------------+---------------+-------------+-----------+-------------------+----------------------+--------------------+--------------------+----------+------------------------+--------------------+------------------+-------------+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-------------+
[2025-11-09T11:23:38.803+0000] {subprocess.py:93} INFO - | CUS_0x6ba9|     20272.23|            1776.3525|              4.0|            3.0|         12.0|        1.0|               -1.0|                   5.0|                4.83|                 6.0|      Good|                  33.874|High_spent_Medium...|               332|       Lawyer|   1|   0| 121| 324| 192| 121| 127| 194|  89|   62|  221|  -43|   70|  -15| -124|   14|  211|   42|  154|   45|   2024-12-01|
[2025-11-09T11:23:38.803+0000] {subprocess.py:93} INFO - | CUS_0x74c7|     87853.56|              7527.13|              4.0|            1.0|          4.0|        2.0|                2.0|                   2.0|                9.99|                 4.0|      Good|               27.837519|High_spent_Large_...|               208|   Unemployed|  70| 128| -96| 167|  87| 155| 211|  47| 345|  -49|  152|  114|  133|  167|  200|   69|  266|   66|   60|    7|   2024-12-01|
[2025-11-09T11:23:38.804+0000] {subprocess.py:93} INFO - | CUS_0x78d3|    17773.775|             1388.148|              3.0|            1.0|          2.0|        2.0|                5.0|                   2.0|                4.57|                 4.0|      Good|               31.760332|Low_spent_Small_v...|               318|   Journalist| -45|  65| 123| 124| 140|  94| -29|  43| 131|  183|  146|  182|   16|  149|  172|   97|  242|   17|   78|  137|   2024-12-01|
[2025-11-09T11:23:38.805+0000] {subprocess.py:93} INFO - | CUS_0x7f5d|     20615.79|            1761.9825|              7.0|            7.0|         21.0|        7.0|               56.0|                  13.0|               10.01|                 8.0|  Standard|                37.84495|Low_spent_Small_v...|               148|      Teacher|  78| 412| 134| 171|  47|  69| 238|  75|  90|  241|   81|  173|  129|   86|  139|   64|   96|  194|  146|   95|   2024-12-01|
[2025-11-09T11:23:38.806+0000] {subprocess.py:93} INFO - |  CUS_0xf6c|     76046.25|            6082.1875|              7.0|            3.0|         16.0|        3.0|               17.0|                  19.0|                3.29|                 9.0|  Standard|               22.548635|Low_spent_Small_v...|               368|       Writer| -19|  98| 147|  69| -74|-156|  68|  93|  44|  257|  204|  163|  129|   65|  -78|   72|  281|  130|   -1|   -5|   2024-12-01|
[2025-11-09T11:23:38.806+0000] {subprocess.py:93} INFO - | CUS_0x7e24|     49854.92|            4216.5767|              8.0|            3.0|         17.0|        3.0|               17.0|                  18.0|                8.07|                 5.0|  Standard|               38.213825|             Unknown|               218|Media_Manager| 106|  99|  81| -75|  25| 151| 131|  10| 202|  205|  -50|   18|   63|   71|  193|  168|  -65|    1|  112|  174|   2024-12-01|
[2025-11-09T11:23:38.807+0000] {subprocess.py:93} INFO - | CUS_0xc65a|     33588.38|            2623.0317|              2.0|            1.0|         12.0|        2.0|                0.0|                  11.0|                8.24|                 4.0|      Good|               23.830828|High_spent_Large_...|               324|Media_Manager| -32|  11| 235| 120| 165| -14| -60| 185|  13|  310|  101|  205|   73|   28|  109|  113|  260|  255|  223|   30|   2024-12-01|
[2025-11-09T11:23:38.807+0000] {subprocess.py:93} INFO - |  CUS_0xebe|     28286.24|            2273.1868|              4.0|            7.0|          7.0|        1.0|               21.0|                  13.0|               11.99|                 4.0|  Standard|               28.700365|High_spent_Medium...|               356|   Journalist| 288| 102| -37|  88| -11|  80| 100|  97| 220|    9|  -64|  110|   60|   10|   77|   22|   97|   10|   92|  129|   2024-12-01|
[2025-11-09T11:23:38.808+0000] {subprocess.py:93} INFO - | CUS_0x1ed5|     18965.35|            1317.4458|             10.0|            7.0|         20.0|        3.0|               21.0|                  18.0|                7.33|                 6.0|       Bad|               27.237741|Low_spent_Small_v...|                96|      Teacher| -66| 144| 274| 126| 163| 236| 195| 297|  21|  239|   37|  199|   83|  142|  189|   -3|  187|   93|   -7|  138|   2024-12-01|
[2025-11-09T11:23:38.809+0000] {subprocess.py:93} INFO - | CUS_0x5479|     29365.12|            2524.0933|              5.0|            5.0|         12.0|        1.0|               11.0|                  11.0|                7.04|                 5.0|         _|               25.221605|Low_spent_Large_v...|               316|     Musician|  -5| 104| 109| 156| 233| -81| 165| 128| 161|  -11|  106|   45|  239|   16|  355|   33|  134|  353|  149| -144|   2024-12-01|
[2025-11-09T11:23:38.809+0000] {subprocess.py:93} INFO - | CUS_0xb38d|     18409.79|            1594.1492|              7.0|           10.0|         16.0|        5.0|               33.0|                  25.0|                5.16|                11.0|       Bad|                33.87914|Low_spent_Small_v...|               111|      Teacher| 218|  21|  81| 113|  72| 171|  77| 160| 181|   87|  133|   79|   96|  173|  138|  197|  201|  157|  138|  -25|   2024-12-01|
[2025-11-09T11:23:38.810+0000] {subprocess.py:93} INFO - | CUS_0xafeb|     15910.33|            1111.8608|              8.0|            8.0|         21.0|        9.0|               16.0|                  16.0|               15.26|                 8.0|         _|               30.943031|High_spent_Medium...|               170|      Manager|  15| 194| -25|  48|  44| 287| 142| 257| 192| -149|   60|  272|  100|  163|   87|   94|   23|   76|  280|  207|   2024-12-01|
[2025-11-09T11:23:38.810+0000] {subprocess.py:93} INFO - | CUS_0x8d3d|     16750.04|            1435.8367|              9.0|           10.0|         27.0|        6.0|               41.0|                  19.0|                29.4|                15.0|       Bad|               23.590292|Low_spent_Small_v...|               144|      Manager| 169| 258| 111|  78|  12| 130| 367| 108| 203|  255|  235|  124|  255|  195|  114|   49|   50|  109|   25|  172|   2024-12-01|
[2025-11-09T11:23:38.811+0000] {subprocess.py:93} INFO - | CUS_0x9d41|     41015.55|            3152.9624|              0.0|            4.0|          4.0|        1.0|                9.0|                   2.0|                1.58|                 2.0|      Good|               31.356266|Low_spent_Small_v...|               306|       Lawyer| 112| 190|   0| 282| 229| 108|  15| 117| 145|   -9|  276|  190|  142|   79|  114|   63|   10|   53|  112|   32|   2024-12-01|
[2025-11-09T11:23:38.812+0000] {subprocess.py:93} INFO - | CUS_0xbd2c|     29647.92|              2329.66|              6.0|            4.0|         19.0|        4.0|                7.0|                  10.0|                16.9|                 5.0|  Standard|                35.95066|Low_spent_Small_v...|               216|    Scientist| -44| 158| 228| 180|  29|   9|  67|  74|  85|  192|  190|  -65|   66|  176| -105|  -85|  101|  112|   94| -119|   2024-12-01|
[2025-11-09T11:23:38.812+0000] {subprocess.py:93} INFO - | CUS_0x5e1f|     16640.35|            1253.6958|              5.0|            6.0|          9.0|        1.0|               21.0|                   8.0|                7.24|                 5.0|         _|               32.371017|Low_spent_Small_v...|               213|    Developer|  84| 273|  25| 139| 116|  17| -90|  17|  74|   90|  107|   62|  178|  -20|  125|  -77|   -1|  152|  273|   80|   2024-12-01|
[2025-11-09T11:23:38.813+0000] {subprocess.py:93} INFO - | CUS_0x8526|     95596.35|             8205.362|              0.0|            3.0|          2.0|        3.0|               12.0|                   1.0|                4.98|                 6.0|         _|               34.768803|High_spent_Large_...|               351|   Unemployed| 305|  30|  26| 213| 131| 171| -63|  54| 209|  174|   36|  236|  173|   68|  100|  128|  -62|   84|   -2|   55|   2024-12-01|
[2025-11-09T11:23:38.813+0000] {subprocess.py:93} INFO - | CUS_0xa455|    112745.76|              9193.48|              3.0|            7.0|          2.0|        3.0|               12.0|                   6.0|                4.27|                 7.0|      Good|               27.182964|Low_spent_Medium_...|               196|       Doctor| 157| 231|  94|  97| -10|  87| 249|  97|  85|  -86|  -86|  268|   93|  278|   97|  152|   92|  142|   57|  -42|   2024-12-01|
[2025-11-09T11:23:38.814+0000] {subprocess.py:93} INFO - | CUS_0xa980|     70360.58|             6051.382|              3.0|            6.0|         12.0|        1.0|               10.0|                   7.0|                1.15|                 2.0|      Good|               40.068634|Low_spent_Small_v...|               218|     Mechanic| -58| 235|  87| 198| 196|  97| 103| 131| 139|   28|    1|  198|  271|  323|   79|  -17|   27|   80|  196|   42|   2024-12-01|
[2025-11-09T11:23:38.814+0000] {subprocess.py:93} INFO - | CUS_0x3c41|     38561.33|             3289.444|              0.0|            6.0|         10.0|        0.0|                5.0|                   0.0|                2.34|                 2.0|         _|               25.851448|High_spent_Small_...|               330|      Manager|  56| 162|  96|  69| 227|  11|-101| -33| -51|  415|   83|  174|  177|  126|  -84|  255|  189|  218|    7|   71|   2024-12-01|
[2025-11-09T11:23:38.815+0000] {subprocess.py:93} INFO - +-----------+-------------+---------------------+-----------------+---------------+-------------+-----------+-------------------+----------------------+--------------------+--------------------+----------+------------------------+--------------------+------------------+-------------+----+----+----+----+----+----+----+----+----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-----+-------------+
[2025-11-09T11:23:38.816+0000] {subprocess.py:93} INFO - only showing top 20 rows
[2025-11-09T11:23:41.038+0000] {subprocess.py:93} INFO - [Stage 7:====================================================>    (11 + 1) / 12]                                                                                [Stage 8:>                                                        (0 + 12) / 12]
[2025-11-09T11:23:41.040+0000] {subprocess.py:93} INFO - datamart/gold/model_predictions/
[2025-11-09T11:23:41.040+0000] {subprocess.py:93} INFO - saved to: datamart/gold/model_predictions/xgb_credit_model_2024_09_01_predictions_2024_12_01.parquet
[2025-11-09T11:23:41.649+0000] {subprocess.py:97} INFO - Command exited with return code 0
[2025-11-09T11:23:41.683+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-11-09T11:23:41.684+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=scheduled_training_dag, task_id=inference, run_id=scheduled__2025-01-01T00:00:00+00:00, execution_date=20250101T000000, start_date=20251109T112328, end_date=20251109T112341
[2025-11-09T11:23:41.726+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-11-09T11:23:41.756+0000] {taskinstance.py:3900} INFO - 2 downstream tasks scheduled from follow-on schedule check
[2025-11-09T11:23:41.768+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
